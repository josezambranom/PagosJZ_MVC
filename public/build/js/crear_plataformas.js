!function(){document.querySelector("#form_plataforma").addEventListener("submit",(function(e){e.preventDefault();const t=document.querySelector("#plataforma"),r=document.querySelector("#precio"),n=document.querySelector("#estado"),c=document.querySelector("#categoria"),i=document.querySelector("#imagen"),l=t.value.trim(),s=r.value.trim(),u=n.value,d=c.value,m=i.files[0];if(!(l&&s&&u&&d&&a)&&!m)return void o("warning","¡Importante!","Todos los campos son obligatorios");if(!/^-?\d*\.?\d+$/.test(s))return o("error","¡Oh no!","El formato del precio es incorrecto. Debe ser un número válido (entero o decimal)"),void(r.value="");t.value="",r.value="",n.value="",c.value="",i.value="",async function(e,t,r,n,c){datos=new FormData,datos.append("plataforma",e),datos.append("precio",t),datos.append("estado",r),datos.append("categoria",n),c&&datos.append("imagen",c);let i="",l="",s=!1;a?(datos.append("id",a),i="/plataforma/actualizar",l="Plataforma actualizada con éxito",s=!0):(i="/plataforma/crear",l="La plataforma se ha creado con éxito");try{if(respuesta=await fetch(i,{method:"POST",body:datos}),resultado=await respuesta.json(),resultado.error)return void o("error","¡Oh no!",resultado.error);o("success","¡Bien hecho!",l,s,"/admin/plataformas")}catch(e){o("error","¡Oh no!","Ocurrió un error al procesar esta solicitud"),console.log(e)}}(l,s,u,d,m)}));const e=window.location.search??!1;let a="";if(e&&e.length>1){const o=new URLSearchParams(e);a=o.get("id"),async function(e){const a="/plataforma/productos",o=document.querySelector(".img_form"),t={1:{name:"streaming"},2:{name:"videojuegos"},3:{name:"recargas"}};try{respuesta=await fetch(a),resultado=await respuesta.json(),resultado.forEach((a=>{if(a.id===e){const e=t[a.categoria];document.querySelector("#plataforma").value=a.plataforma,document.querySelector("#precio").value=a.precio,document.querySelector("#estado").value=a.estado,document.querySelector("#categoria").value=a.categoria;const r=document.createElement("img");r.src=`/imagenes/${e.name}/${a.imagen}`,r.classList.add("form-img"),r.alt=a.plataforma,o.appendChild(r)}}))}catch(e){console.log(e)}}(a)}function o(e,a,o,t=!1,r=""){Swal.fire({icon:e,title:a,text:o,allowOutsideClick:!1}).then((e=>{e.isConfirmed&&t&&(window.location.href=r)}))}}();